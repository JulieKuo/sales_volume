The main process and chart can be seen in model.ipynb.